nn â† â€¢Import "nn.bqn"

rand â† â€¢MakeRand 0

n1 â† nn.Normal randâ€¿âŸ¨0, 1âŸ©
â€¢Show n1

n2 â† nn.Normal randâ€¿âŸ¨0, 1âŸ©
â€¢Show n2

n3 â† nn.Normal rand
â€¢Show n3

n4 â† 3 nn.Normal randâ€¿âŸ¨0, 1âŸ©
â€¢Show n4

n5 â† 3 nn.Normal rand
â€¢Show n5

n6 â† 2â€¿3 nn.Normal rand
â€¢Show n6

ps â† nn.InitializeParameters 3â€¿2â€¿1
â€¢Out "w1 = "âˆ¾â€¢Repr ps.w1
â€¢Out "b1 = "âˆ¾â€¢Repr ps.b1
â€¢Out "w2 = "âˆ¾â€¢Repr ps.w2
â€¢Out "b2 = "âˆ¾â€¢Repr ps.b2

! 2â€¿3 â‰¡ â‰¢ps.w1
! âŸ¨2âŸ© â‰¡ â‰¢ps.b1
! âˆ§Â´=âŸœ0Â¨â¥Šps.b1
! 1â€¿2 â‰¡ â‰¢ps.w2
! âŸ¨1âŸ© â‰¡ â‰¢ps.b2
! âˆ§Â´=âŸœ0Â¨â¥Šps.b2

wsâ€¿bs â† nn.InitializeParametersDeep 5â€¿4â€¿3

! 2=â‰ ws
! 2=â‰ bs
! 4â€¿5â‰¡â‰¢0âŠ‘ws
! (â‰ =â‰ âˆ˜â·)0âŠ‘ws  # all unique
! (4â¥Š0)â‰¡0âŠ‘bs
! 3â€¿4â‰¡â‰¢1âŠ‘ws
! (â‰ =â‰ âˆ˜â·)1âŠ‘ws  # all unique
! (3â¥Š0)â‰¡1âŠ‘bs

x â† @
y â† @
a â† @
w â† @
b â† @
z â† @
aa â† @
ww â† @
bb â† @
zz â† @
aPrev â† @
aL â† @
caches â† @

a â†© [[ 1.62434536, -0.61175641]
     [-0.52817175, -1.07296862]
     [ 0.86540763, -2.3015387 ]]
w â†© [[1.74481176, -0.7612069,   0.3190391]]
b â†© âŸ¨-0.24937038âŸ©
z â†© [[ 3.26295337, -1.23429987]]

zzâ€¿âŸ¨aaâ€¿wwâ€¿bbâŸ© â†© nn.LinearForward aâ€¿wâ€¿b

Close â† {
  d ğ•Š vs: âˆ§Â´ 0âŠ¸=Â¨ â‰ âˆ˜â‰¢Â¨ vs ? (1=â‰ âˆ˜â·) { (10â‹†d)Ã·ËœâŒŠğ•©Ã—(10â‹†d) }Â¨ vs ;
  d ğ•Š vs: (1â‰ â‰ âˆ˜â·) â‰¢Â¨ vs ? 0 ;
  d ğ•Š vs: (1=â‰ âˆ˜â·) { (10â‹†d)Ã·ËœâŒŠğ•©Ã—(10â‹†d) }Â¨ â¥ŠÂ¨ vs
}

! (â‰¢z)â‰¡â‰¢zz

! 7 Close zâ€¿zz

aPrev â†© [[-0.41675785, -0.05626683]
         [-2.1361961,   1.64027081]
         [-1.79343559, -0.84174737]]
w â†© [[ 0.50288142, -1.24528809, -1.05795222]]
b â†© âŸ¨-0.90900761âŸ©

truth â† {
  aWithSigmoid â‡ [[0.96890023, 0.11013289]]
  aWithReLU â‡ [[3.43896131, 0.0        ]]
}

aWithSigmoidâ€¿Â· â† nn.LinearActivationForward aPrevâ€¿wâ€¿bâ€¿nn.sigmoid
aWithReLUâ€¿Â· â† nn.LinearActivationForward aPrevâ€¿wâ€¿bâ€¿nn.reLU

#â€¢Out "aWithSigmoid"
#â€¢Show truth.aWithSigmoid
#â€¢Show aWithSigmoid

#â€¢Out "aWithReLU"
#â€¢Show truth.aWithReLU
#â€¢Show aWithReLU

! 7 Close truth.aWithSigmoidâ€¿aWithSigmoid
! 7 Close truth.aWithReLUâ€¿aWithReLU

x â†© [[-0.31178367,  0.72900392,  0.21782079, -0.8990918 ]
     [-2.48678065,  0.91325152,  1.12706373, -1.51409323]
     [ 1.63929108, -0.42989360,  2.63128056,  0.60182225]
     [-0.33588161,  1.23773784,  0.11112817,  0.12915125]
     [ 0.07612761, -0.15512816,  0.63422534,  0.810655  ]]
ws â†© âŸ¨
      [[ 0.35480861,  1.81259031, -1.3564758 , -0.46363197,  0.82465384]
       [-1.17643148,  1.56448966,  0.71270509, -0.1810066 ,  0.53419953]
       [-0.58661296, -1.48185327,  0.85724762,  0.94309899,  0.11444143]
       [-0.02195668, -2.12714455, -0.83440747, -0.46550831,  0.23371059]]
      [[-0.12673638, -1.36861282,  1.21848065, -0.85750144]
       [-0.56147088, -1.0335199 ,  0.35877096,  1.07368134]
       [-0.37550472,  0.39636757, -0.47144628,  2.33660781]]
      [[ 0.9398248 ,  0.42628539, -0.75815703]]
     âŸ©
bs â†© âŸ¨âŸ¨ 1.38503523
       -0.51962709
       -0.78015214
        0.95560959 âŸ©
      âŸ¨ 1.50278553
       -0.59545972
        0.52834106 âŸ©
      âŸ¨-0.16236698 âŸ©
     âŸ©

truthAL â† [[0.03921668, 0.70498921, 0.19734387, 0.04728177]]

aLâ€¿caches â†© nn.LModelForward xâ€¿wsâ€¿bs

#â€¢Show truthAL
#â€¢Show aL

! 7 Close truthALâ€¿aL
! 3=â‰ caches

y â†© [[1, 1, 0]]
aL â†© [[0.8, 0.9, 0.4]]

truthCost â† 0.2797765635793422

cost â† nn.ComputeCost aLâ€¿y

! 7 Close truthCostâ€¿cost
