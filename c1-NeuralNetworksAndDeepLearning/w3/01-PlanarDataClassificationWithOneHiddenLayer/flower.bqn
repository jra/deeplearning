nn â† â€¢Import "nn-1layer.bqn"
âŸ¨DotâŸ© â† â€¢Import "../../../libs/numb.bqn"

LoadPlanarDataset â† {
  Â·:
  rng â† â€¢MakeRand 1
  m â† 400 # number of examples
  n â† âŒŠmÃ·2 # number of points per class
  d â† 2 # dimensionality
  #x â† mâ€¿Dâ¥Š0 # data matrix where each row is a single example
  #y â† mâ€¿1â¥Š0 # labels vector (0 for red, 1 for blue)
  a â† 4 # maximum ray of the flower
  xy â† {
    t â† ((3.12Ã—ğ•©) + (3.12Ã—(n-1)Ã·Ëœâ†•n)) + 0.2 Ã— {ğ•© nn.Normal 0â€¿1}Â¨ n rng.Range 0
    r â† (aÃ—â€¢math.SinÂ¨4Ã—t) + 0.2 Ã— {ğ•© nn.Normal 0â€¿1}Â¨ n rng.Range 0
    x0 â† rÃ—â€¢math.SinÂ¨t
    x1 â† rÃ—â€¢math.CosÂ¨t
    y â† nâ¥Šğ•©
    (â‰x0â‰x1)â€¿y
  }Â¨0â€¿1
  x â† âˆ¾âŠ‘Â¨xy
  y â† â‰â‰âˆ¾1âŠ¸âŠ‘Â¨xy
  â‰Â¨xâ€¿y
}

xâ€¿y â† LoadPlanarDataset @
#â€¢Show â‰¢âŠ‘xy
#â€¢Show â‰¢1âŠ‘xy

#ds â† â‰(âŠ‘xy)âˆ¾1âŠ‘xy
ds â† (â‰x)âˆ¾Ë˜â‰y
â€¢Out "ds:"
â€¢Show â‰¢ds
"dataset.csv" â€¢file.Lines âŸ¨"x0,x1,y"âŸ©âˆ¾{(nn.FmtNeg 0âŠ‘ğ•©)âˆ¾","âˆ¾(nn.FmtNeg 1âŠ‘ğ•©)âˆ¾","âˆ¾(nn.FmtNeg 2âŠ‘ğ•©)}Â¨<Ë˜ds

#x â† âŠ‘xy
#y â† 1âŠ‘xy
shape_x â† â‰¢x
shape_y â† â‰¢y
m â† â‰ y
â€¢Out "The shape of x is: "âˆ¾â€¢Repr shape_x
â€¢Out "The shape of y is: "âˆ¾â€¢Repr shape_y
â€¢Out "I have m = "âˆ¾(â€¢Repr m)âˆ¾" training examples!"

â€¢Out "x:"
â€¢Show â‰¢x
â€¢Out "y:"
â€¢Show â‰¢y

parameters â† nn.NNModel xâ€¿yâ€¿4â€¿1.2â€¿10000â€¿1
predictions â† nn.Predict parametersâ€¿x
â€¢Out "Accuracy: "âˆ¾â€¢Repr 100Ã— (1âŠ‘â‰¢y)Ã·Ëœ (y Dot â‰predictions) + (Â¬y) Dot â‰Â¬predictions
