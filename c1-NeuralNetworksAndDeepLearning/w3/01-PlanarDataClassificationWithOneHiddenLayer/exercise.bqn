# Normal Deviates by Ratio-of-Uniforms
# Numerical Recipes 7.3.9
Normal â† {
  r ğ•Š muâ€¿sig:
  rand â† â€¢MakeRand r
  qâ€¿uâ€¿v â† 3â¥Š0
  {
    u â†© rand.Range 0
    v â†© 1.7156 Ã— (rand.Range 0) - 0.5
    x â† u - 0.449871
    y â† 0.386595 + |v
    q â†© (xâ‹†2) + y Ã— (yÃ—0.19600) - xÃ—0.25472
    ğ•ŠâŸ((q>0.27597) âˆ§ ((q>0.27846) âˆ¨ ((vâ‹†2) > Â¯4.0Ã—(â‹†â¼u)Ã—uâ‹†2))) @
  } @
  mu+sigÃ—vÃ·u
}

rng â† â€¢MakeRand 0

#n â† rng Normal 0â€¿1
#â€¢Show n
#n â†© rng Normal 0â€¿1
#â€¢Show n
#ns â† {rng Normal 0â€¿1}Â¨100â¥Š0
#â€¢Show ns

#n â† (rng.Range 0) Normal 0â€¿1
#â€¢Show n
#n â†© (rng.Range 0) Normal 0â€¿1
#â€¢Show n
#ns â† {ğ•© Normal 0â€¿1}Â¨ 1000 rng.Range 0
#â€¢Show â‰ ns
#â€¢Show âŒŠÂ´ns
#â€¢Show âŒˆÂ´ns
#mean_ns â† (+Â´Ã·â‰ ) ns
#â€¢Out "mean_ns: "âˆ¾â€¢Repr mean_ns
#var_ns â† (â‰ ns)Ã·Ëœ+Â´2â‹†Ëœns-mean_ns
#â€¢Out "var_ns: "âˆ¾â€¢Repr var_ns

FmtNeg â† {
  a â† â€¢Fmt ğ•©
  (âŠ£+=Ã—'-'âŠ¸-)âŸœ'Â¯' a
}
#
#"normals.csv" â€¢file.Lines âŸ¨"vals"âŸ©âˆ¾FmtNegÂ¨ns

LoadPlanarDataset â† {
  Â·:
  rng â† â€¢MakeRand 1
  m â† 400 # number of examples
  n â† âŒŠmÃ·2 # number of points per class
  d â† 2 # dimensionality
  #x â† mâ€¿Dâ¥Š0 # data matrix where each row is a single example
  #y â† mâ€¿1â¥Š0 # labels vector (0 for red, 1 for blue)
  a â† 4 # maximum ray of the flower
  xy â† {
    t â† ((3.12Ã—ğ•©) + (3.12Ã—(n-1)Ã·Ëœâ†•n)) + 0.2 Ã— {ğ•© Normal 0â€¿1}Â¨ n rng.Range 0
    r â† (aÃ—â€¢math.SinÂ¨4Ã—t) + 0.2 Ã— {ğ•© Normal 0â€¿1}Â¨ n rng.Range 0
    x0 â† rÃ—â€¢math.SinÂ¨t
    x1 â† rÃ—â€¢math.CosÂ¨t
    y â† nâ¥Šğ•©
    (â‰x0â‰x1)â€¿y
  }Â¨0â€¿1
  x â† âˆ¾âŠ‘Â¨xy
  y â† âˆ¾1âŠ¸âŠ‘Â¨xy
  â‰Â¨xâ€¿y
}

xy â† LoadPlanarDataset @
â€¢Show â‰¢âŠ‘xy
â€¢Show â‰¢1âŠ‘xy

ds â† â‰(âŠ‘xy)âˆ¾1âŠ‘xy
"dataset.csv" â€¢file.Lines âŸ¨"x0,x1,y"âŸ©âˆ¾{(FmtNeg 0âŠ‘ğ•©)âˆ¾","âˆ¾(FmtNeg 1âŠ‘ğ•©)âˆ¾","âˆ¾(FmtNeg 2âŠ‘ğ•©)}Â¨<Ë˜ds

x â† âŠ‘xy
y â† 1âŠ‘xy
shape_x â† â‰¢x
shape_y â† â‰¢y
m â† â‰ y
â€¢Out "The shape of x is: "âˆ¾â€¢Repr shape_x
â€¢Out "The shape of y is: "âˆ¾â€¢Repr shape_y
â€¢Out "I have m = "âˆ¾(â€¢Repr m)âˆ¾" training examples!"

LayerSizes â† {
  xâ€¿y:
  n_x â† âŠ‘â‰¢x
  n_h â† 4
  n_y â† (1==y)âŠ‘âŸ¨âŠ‘â‰¢y, 1âŸ©
  n_xâ€¿n_hâ€¿n_y
}

LayerSizesTesCase â† {
  Â·:
  rng â† â€¢MakeRand 1
  x_assess â† 5â€¿3 rng.Range 0
  y_assess â† 2â€¿3 rng.Range 0
  x_assessâ€¿y_assess
}

n_xâ€¿n_hâ€¿n_y â† 3â¥Š@

x_assessâ€¿y_assess â† LayerSizesTesCase @
n_xâ€¿n_hâ€¿n_y â†© LayerSizes x_assessâ€¿y_assess
â€¢Out "The size of the input layer is: n_x = "âˆ¾ â€¢Repr n_x
â€¢Out "The size of the hidden layer is: n_h = "âˆ¾ â€¢Repr n_h
â€¢Out "The size of the output layer is: n_y = "âˆ¾ â€¢Repr n_y

InitializeParameters â† {
  n_xâ€¿n_hâ€¿n_y:
  rng â† â€¢MakeRand 2

  w1 â† 0.01 Ã— {ğ•© Normal 0â€¿1}Â¨ n_hâ€¿n_x rng.Range 0
  b1 â† n_hâ€¿1â¥Š0
  w2 â† 0.01 Ã— {ğ•© Normal 0â€¿1}Â¨ n_yâ€¿n_h rng.Range 0
  b2 â† n_yâ€¿1â¥Š0

  â€¢Show â‰¢w1
  â€¢Show â‰¢b1
  â€¢Show â‰¢w2
  â€¢Show â‰¢b2

  #! n_hâ€¿n_x=â‰¢w1
  #! n_hâ€¿1=â‰¢b1
  #! n_yâ€¿n_h=â‰¢w2
  #! n_yâ€¿1=â‰¢b2

  w1â€¿b1â€¿w2â€¿b2
}

InitializeParametersTestCase â† {
  Â·:
  n_xâ€¿n_hâ€¿n_y â† 2â€¿4â€¿1
  n_xâ€¿n_hâ€¿n_y
}

n_xâ€¿n_hâ€¿n_y â†© InitializeParametersTestCase @

parameters â† InitializeParameters n_xâ€¿n_hâ€¿n_y
â€¢Out "W1 = "âˆ¾â€¢Repr 0âŠ‘parameters
â€¢Out "b1 = "âˆ¾â€¢Repr 1âŠ‘parameters
â€¢Out "W2 = "âˆ¾â€¢Repr 2âŠ‘parameters
â€¢Out "b2 = "âˆ¾â€¢Repr 3âŠ‘parameters
