path_libreaddata â† "/Users/jra/prj/coursera/deeplearning/c1-NeuralNetworksAndDeepLearning/w2/02-LogisticRegressionWithANeuralNetworkMindset/libreaddata.dylib"
readTrainX â† path_libreaddata â€¢FFI "a"â€¿"read_train_x"
readTrainY â† path_libreaddata â€¢FFI "a"â€¿"read_train_y"
readTestX â† path_libreaddata â€¢FFI "a"â€¿"read_test_x"
readTestY â† path_libreaddata â€¢FFI "a"â€¿"read_test_y"
readTestListClasses â† path_libreaddata â€¢FFI "a"â€¿"read_test_list_classes"

train_set_x_orig â† @ -Ëœ ReadTrainX âŸ¨âŸ©
train_set_y â† ReadTrainY âŸ¨âŸ©
test_set_x_orig â† @ -Ëœ ReadTestX âŸ¨âŸ©
test_set_y â† ReadTestY âŸ¨âŸ©
classes â† ReadTestListClasses âŸ¨âŸ©

index â† 10
â€¢Out "y = "âˆ¾(â€¢Repr indexâŠ‘train_set_y)âˆ¾", it's a '"âˆ¾((indexâŠ‘train_set_y)âŠ‘classes)âˆ¾"' picture."
ImageWrite â† {
  # write image to file:
  # ppm ex.
  # 4 8  4 columns, 8 rows
  # 255  max value
  # data read in rows
  rowsâ€¿colsâ€¿ignore â† â‰¢ğ•©  # ie 64 Ã— 64 Ã— 3
  header_ppm â† "P6
"âˆ¾(â€¢Repr cols)âˆ¾" "âˆ¾(â€¢Repr rows)âˆ¾"
255
"
  image_ppm â† @âŠ¸+Â¨ â¥Šğ•©
  bytes_ppm â† header_ppm âˆ¾ image_ppm
  ğ•¨ â€¢file.Bytes bytes_ppm
}
("img-train"âˆ¾(â€¢Repr index)âˆ¾".ppm") ImageWrite index âŠ train_set_x_orig

m_train â† â‰ train_set_x_orig
m_test â† â‰ test_set_x_orig
num_px â† 1âŠ‘â‰¢train_set_x_orig

â€¢Out "Number of training examples: m_train = "âˆ¾â€¢Repr m_train
â€¢Out "Number of testing examples: m_test = "âˆ¾â€¢Repr m_test
â€¢Out "Height/Width of each image: num_px = "âˆ¾â€¢Repr num_px
â€¢Out "Each image is of size: "âˆ¾â€¢Repr â‰¢âŠtrain_set_x_orig
â€¢Out "train_set_x shape: "âˆ¾â€¢Repr â‰¢train_set_x_orig
â€¢Out "train_set_y shape: "âˆ¾â€¢Repr â‰¢train_set_y
â€¢Out "test_set_x shape: "âˆ¾â€¢Repr â‰¢test_set_x_orig
â€¢Out "test_set_y shape: "âˆ¾â€¢Repr â‰¢test_set_y

train_set_x_flatten â† â‰ (â‰ train_set_x_orig)â€¿âˆ˜ â¥Š train_set_x_orig
test_set_x_flatten â† â‰ (â‰ test_set_x_orig)â€¿âˆ˜ â¥Š test_set_x_orig

â€¢Out "train_set_x_flatten shape: "âˆ¾â€¢Repr â‰¢train_set_x_flatten
â€¢Out "train_set_y shape: "âˆ¾â€¢Repr â‰¢train_set_y
â€¢Out "test_set_x_flatten shape: "âˆ¾â€¢Repr â‰¢test_set_x_flatten
â€¢Out "test_set_y shape: "âˆ¾â€¢Repr â‰¢test_set_y
â€¢Out "sanity check after reshpaing: "âˆ¾â€¢Repr 5â†‘âŠâ‰1 train_set_x_flatten

train_set_x â† train_set_x_flatten Ã· 255
test_set_x â† test_set_x_flatten Ã· 255

Sigmoid â† { Ã·1+â‹†-ğ•© }

â€¢Out "Sigmoid "âˆ¾(â€¢Repr 0â€¿2)âˆ¾" = "âˆ¾â€¢Repr Sigmoid 0â€¿2

InitializeWithZeros â† { (ğ•©â€¿1â¥Š0)â€¿0 }

tdim â† 2
twâ€¿tb â† InitializeWithZeros tdim

â€¢Out "tw = "âˆ¾â€¢Repr tw
â€¢Out "tb = "âˆ¾â€¢Repr tb

numb â† â€¢Import "numb.bqn"

Propagate â† {
  wâ€¿bâ€¿xâ€¿y:
  m â† 1âŠ‘â‰¢y
  n â† âŠ‘â‰¢w
  a â† Sigmoid b + (â‰w) numb.Dot x
  cost â† âŠ‘-Ã·âŸœm+Ëâ‰(yÃ—â‹†â¼a)+(Â¬y)Ã—â‹†â¼Â¬a
  dw â† Ã·âŸœm x numb.Dot â‰a-y
  db â† âŠ‘ Ã·âŸœm +Ëâ‰a-y
  âŸ¨dwâ€¿db, costâŸ©
}

wâ€¿bâ€¿xâ€¿y â† âŸ¨âˆ˜â€¿1â¥Š1â€¿2, 2, >âŸ¨1â€¿2â€¿Â¯1, 3â€¿4â€¿Â¯3.2âŸ©, 1â€¿âˆ˜â¥Š1â€¿0â€¿1âŸ©
gradsâ€¿cost â† Propagate wâ€¿bâ€¿xâ€¿y

â€¢Out "Propagate test:"
â€¢Out "dw = "âˆ¾â€¢Repr âŠ‘grads
â€¢Out "db = "âˆ¾â€¢Repr 1âŠ‘grads
â€¢Out "cost = "âˆ¾â€¢Repr cost

Optimize â† {
  wâ€¿bâ€¿xâ€¿yâ€¿dwâ€¿dbâ€¿costsâ€¿num_iterationsâ€¿learning_rateâ€¿print_cost:
  gradsâ€¿cost â† @â€¿@
  i â† 0
  {
    ğ•¤
    {
      gradsâ€¿cost â†© Propagate wâ€¿bâ€¿xâ€¿y
      dwâ€¿db â†© grads
      w -â†© learning_rateÃ—dw
      b -â†© learning_rateÃ—db
      {ğ•¤,costs âˆ¾â†© ğ•©}âŸ(0=100|i) cost
      {ğ•¤,â€¢Out â€¢Fmt ğ•©}âŸ(print_cost âˆ§ 0=100|i) cost
      i +â†© 1
    }
  }âŸnum_iterations @
  âŸ¨w, bâŸ©â€¿âŸ¨dw, dbâŸ©â€¿costs
}

dwâ€¿dbâ€¿num_iterationsâ€¿learning_rateâ€¿print_cost â† @â€¿@â€¿@â€¿@â€¿@
params â† @
costs â† âŸ¨âŸ©
wâ€¿bâ€¿xâ€¿yâ€¿dwâ€¿dbâ€¿costsâ€¿num_iterationsâ€¿learning_rateâ€¿print_cost â†© âŸ¨w, b, x, y, 0, 0, âŸ¨âŸ©, 100, 0.009, 0âŸ©
paramsâ€¿gradsâ€¿costs â†© Optimize wâ€¿bâ€¿xâ€¿yâ€¿dwâ€¿dbâ€¿costsâ€¿num_iterationsâ€¿learning_rateâ€¿print_cost

â€¢Out "Optimize test:"
â€¢Out "w = "âˆ¾â€¢Repr âŠparams
â€¢Out "b = "âˆ¾â€¢Repr 1âŠparams
â€¢Out "dw = "âˆ¾â€¢Repr âŠ‘grads
â€¢Out "db = "âˆ¾â€¢Repr 1âŠ‘grads

Predict â† {
  wâ€¿bâ€¿x:
  m â† 1âŠ‘â‰¢x
  y_prediction â† 1â€¿mâ¥Š0
  w â†© (âŠ‘â‰¢x)â€¿1â¥Šw
  a â† Sigmoid b + (â‰w) numb.Dot x
  y_prediction â†© a>0.5
  y_prediction
}

wâ€¿bâ€¿x â†© âŸ¨âˆ˜â€¿1â¥Š0.1124579â€¿0.23106775, Â¯0.3, >âŸ¨1.0â€¿Â¯1.1â€¿Â¯3.2, 1.2â€¿2.0â€¿0.1âŸ©âŸ©
â€¢Out "predictions = "âˆ¾â€¢Repr Predict wâ€¿bâ€¿x

Model â† {
  x_trainâ€¿y_trainâ€¿x_testâ€¿y_testâ€¿num_iterationsâ€¿learning_rateâ€¿print_cost:
  wâ€¿b â† InitializeWithZeros âŠ‘â‰¢x_train
  dwâ€¿dbâ€¿costs â† @â€¿@â€¿âŸ¨âŸ©
  parametersâ€¿grads â† @â€¿@
  parametersâ€¿gradsâ€¿costs â†© Optimize wâ€¿bâ€¿x_trainâ€¿y_trainâ€¿dwâ€¿dbâ€¿costsâ€¿num_iterationsâ€¿learning_rateâ€¿print_cost

  # Retrieve parameters w and b from dictionary "parameters"
  wâ€¿b â†© parameters

  # Predict test/train set examples (â‰ˆ 2 lines of code)
  y_prediction_test â† Predict wâ€¿bâ€¿x_test
  y_prediction_train â† Predict wâ€¿bâ€¿x_train

  # Print train/test Errors
  â€¢Out "train accuracy: "âˆ¾(â€¢Repr âŠ‘100-100Ã—(+Â´Ã·â‰ )Ë˜|y_prediction_train-y_train)âˆ¾"%"
  â€¢Out "test accuracy: "âˆ¾(â€¢Repr âŠ‘100-100Ã—(+Â´Ã·â‰ )Ë˜|y_prediction_test-y_test)âˆ¾"%"

  âŸ¨
    costs
    y_prediction_test
    y_prediction_train
    w
    b
    learning_rate
    num_iterations
  âŸ©
}

num_iterationsâ€¿learning_rateâ€¿print_cost â†© 2000â€¿0.005â€¿0
#num_iterationsâ€¿learning_rateâ€¿print_cost â†© 40â€¿0.005â€¿0
train_set_y â†© 1â€¿âˆ˜â¥Štrain_set_y
test_set_y â†© 1â€¿âˆ˜â¥Štest_set_y
d â† Model train_set_xâ€¿train_set_yâ€¿test_set_xâ€¿test_set_yâ€¿num_iterationsâ€¿learning_rateâ€¿print_cost
#â€¢Out "b "âˆ¾â€¢Fmt 4âŠ‘d
#â€¢Out "costs "âˆ¾â€¢Fmt âŠ‘d
#â€¢Out "costs "âˆ¾â€¢Fmt Â¯1âŠ‘âŠ‘d

index â†© 25
("img-test"âˆ¾(â€¢Repr index)âˆ¾".ppm") ImageWrite index âŠ test_set_x_orig
â€¢Show â‰¢test_set_y
â€¢Show â€¢Repr test_set_y
â€¢Show â‰¢1âŠ‘d
â€¢Out "y = "âˆ¾(â€¢Repr (0â€¿index)âŠ‘test_set_y)âˆ¾", you predicted that it is a """âˆ¾(â€¢Repr ((0â€¿index)âŠ‘1âŠ‘d)âŠ‘classes)âˆ¾""" picture."

#costs_csv_lines â† "iter,cost"âˆ¾â€¢ReprÂ¨
costs â†© âŠ‘d
â€¢Show costs
â€¢Show â‰¢costs
â€¢Show â‰ costs
iters â† 100Ã—â†•â‰ costs
â€¢Show iters
â€¢Show â‰¢iters
â€¢Show â‰ iters
â€¢Show â‰itersâ‰costs
ics â† â‰itersâ‰costs
â€¢Show {(â€¢Repr 0âŠ‘ğ•©)âˆ¾","âˆ¾â€¢Repr 1âŠ‘ğ•©}Â¨<Ë˜ics


"costs.csv" â€¢file.Lines âŸ¨"iters,cost"âŸ©âˆ¾{(â€¢Repr 0âŠ‘ğ•©)âˆ¾","âˆ¾â€¢Repr 1âŠ‘ğ•©}Â¨<Ë˜ics
â€¢SH "python"â€¿"chart_costs.py"

path_libmagickwand â† "/Users/jra/prj/coursera/deeplearning/c1-NeuralNetworksAndDeepLearning/w2/02-LogisticRegressionWithANeuralNetworkMindset/libmagickwand.dylib"
readResizeImage â† path_libmagickwand â€¢FFI "&"â€¿"read_resize_image"â€¿"*i32:c8"â€¿"u32"â€¿"u32"â€¿"&f64"

Norm255 â† {
  mn â† âŒŠÂ´â¥Šğ•©
  mx â† âŒˆÂ´â¥Šğ•©
  0âŒˆÂ¨255âŒŠÂ¨âŒŠÂ¨256Ã—Ã·âŸœ(mx-mn)-âŸœmnğ•©
}

modw â† 3âŠ‘d
modb â† 4âŠ‘d
â€¢Out â€¢Repr â‰¢modw
â€¢Out â€¢Repr modb

imgtemp â† 64â€¿64â€¿3â¥Š0

path_image â† "/Users/jra/Desktop/jra_photo.jpeg"âˆ¾@
hum1 â† Norm255 ReadResizeImage path_imageâ€¿64â€¿64â€¿imgtemp
("hum1.ppm") ImageWrite hum1
hy â† Sigmoid modb + (â‰modw) numb.Dot (64Ã—64Ã—3)â€¿1â¥Šhum1
â€¢Out â€¢Repr hy

path_image â†© "/Users/jra/Desktop/cat1.jpeg"âˆ¾@
cat1 â† Norm255 ReadResizeImage path_imageâ€¿64â€¿64â€¿imgtemp
â€¢Show â€¢Repr 10â†‘âŠcat1
â€¢Show â€¢Repr âŒˆÂ´â¥Šcat1
â€¢Show â€¢Repr âŒŠÂ´â¥Šcat1
â€¢Show â€¢Repr (+Â´Ã·â‰ )â¥Šcat1
("cat1.ppm") ImageWrite cat1
c1y â† Sigmoid modb + (â‰modw) numb.Dot (64Ã—64Ã—3)â€¿1â¥Šcat1
â€¢Out â€¢Repr c1y

path_image â†© "/Users/jra/Desktop/cat2.jpeg"âˆ¾@
cat2 â† Norm255 ReadResizeImage path_imageâ€¿64â€¿64â€¿imgtemp
("cat2.ppm") ImageWrite cat2
c2y â† Sigmoid modb + (â‰modw) numb.Dot (64Ã—64Ã—3)â€¿1â¥Šcat2
â€¢Out â€¢Repr c2y

learning_rates â† 10â‹†-2+â†•3
ds â† {Model train_set_xâ€¿train_set_yâ€¿test_set_xâ€¿test_set_yâ€¿1500â€¿ğ•©â€¿0}Â¨learning_rates

iters â†© â‹ˆ100Ã—â†•â‰ âŠ‘âŠ‘ds
costs â†© âŠ‘Â¨ds
â€¢Show iters
â€¢Show costs
ics â†© â‰>itersâˆ¾costs
â€¢Show â‰¢ics
â€¢Show ics
"costs_3lrs.csv" â€¢file.Lines âŸ¨"iters,0.01,0.001,0.0001"âŸ©âˆ¾{(â€¢Repr 0âŠ‘ğ•©)âˆ¾","âˆ¾(â€¢Repr 1âŠ‘ğ•©)âˆ¾","âˆ¾(â€¢Repr 2âŠ‘ğ•©)âˆ¾","âˆ¾(â€¢Repr 3âŠ‘ğ•©)}Â¨<Ë˜ics
â€¢SH "python"â€¿"chart_costs_3lrs.py"
